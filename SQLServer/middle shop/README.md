# 文件夹主要文件目录
```
|-- middle shop/
    |   |-- database controler/
    |       |-- data/
    |       |   |-- output-item-log/
    |       |   |   |-- [date].csv
    |       |   |
    |       |   |-- from-shop-infor.csv
    |       |   |-- profit.csv
    |       |   |-- to-shop-infor.csv
    |       |
    |       |-- DataBase.cs
    |       |-- FromShop.cs
    |       |-- InputItem.cs
    |       |-- MiddleShop.cs
    |       |-- OutputItem.cs
    |       |-- StyleSheet1.css
    |       |-- ToShop.cs
    |       |-- WebForm1.aspx
    |       |-- WebForm1.aspx.cs
    |
    |-- sql script/
    |   |-- SQLQuery1.sql
    |
    |-- READ.md
```
# 说明书
## 前言
- 本程序作为"数据库系统概论"课程的期末实验考察报告;
- 最好前往GayHub来获取最佳阅读体验, 直接文本阅读作者都不想看了;
- 其实操作很简单易懂不用看说明书自己理解反而更快1点, 但是因为本程序交互性极差, 若是输入稍有纰漏, 虽然不会将错误的输入体现在数据中, 但是页面也不会做出相应的提示;
- 操作很容易出纰漏, 对用户使用极度不友好, 而且很容易出现因为输入错误而崩溃的现象;
- 输入过程中不要点enter, 相当于点击"删库跑路"按钮;
- *注意*根据我的测试, 有时使用chrome浏览器启动程序, 程序的窗口打开在副显示器上时, 在程序运行的过程中将程序窗口拖动至主显示器再与其交互时, 会出现神奇错误"local服务器拒绝访问";
## 说明书目录
- 前言;
- 说明书目录; <- U R here
- 用到的局部名词解释和部分注释;
- UI总览;
- 用到的局部名词解释和部分注释;
- 功能及异常解释;
- 操作步骤;
- 测试数据;
- 存在的主要问题;
- 优化方案;
## 用到的局部名词解释和部分注释
- 0. 动作
    - 0. 进库: 将从商户购买的商品加入仓库中;
    - 1. 出库: 将仓库中的商品售卖给客户;
    - 2. 输入: 将字符串写入至指定的文本框中;
    - 3. 输出: (在某些操作后, )页面自动显示字符串在页面中;
- 1. 事物
    - 0. 库存: 仓库中剩余的商品;
    - 1. 代销处: 中间商, 从商户中购买商品卖给客户;
    - 2. 商户: 卖商品给代销处;
    - 3. 客户: 从代销处买商品;
- 2. 特殊
    - 0. 部分: 根据用户界面, database controler设计页面部分, 源代码WebForm1.aspx等可以将页面划分为8个部分
        - 0. 日期;
        - 1. 进库;
        - 2. 商户;
        - 3. 库存;
        - 4. 出库;
        - 5. 客户;
        - 6. 代销处;
        - 7. 利润;
    - 1. [...] : 表示某...类的统称;
    - 2. "[父].[子]": 声明调用的地址编号;
    - 3. 实验中要求的步骤在[操作步骤].[("...")];
    - 4. ?...?: 题目中没太理解的地方, 然后自己补全了的结果;
## UI总览
```
|-- 日期部分/
|   |-- 文本框/
|       |-- 日期;
|
|-- 进库部分/
|   |-- 按钮/
|   |   |-- 进库;
|   |   |-- 查询;
|   |
|   |-- 表格/
|   |   |-- 表00;
|   |
|   |-- 文本框/
|       |-- 代销处ID
|       |-- 代销处名称;
|       |-- 商品ID;
|       |-- 商品名称;
|       |-- 商品入库数量;
|       |-- 商品进价单价;
|       |-- 商品进价总价;
|       |-- 商户ID;
|       |-- 商户名称;
|
|-- 商户部分/
|   |-- 按钮/
|   |   |-- 查询;
|   |   |-- 代销处查询;
|   |   |-- 补全/更改信息;
|   |   |-- 查看全部;
|   |   |-- 导出全部为表格;
|   |
|   |-- 表格/
|   |   |-- 表00;
|   |
|   |-- 文本框/
|           |-- 商户ID;
|           |-- 商户名称;
|           |-- 联系电话;
|           |-- 代销处ID;
|           |-- 代销处名称;
|
|-- 库存部分/
|   |-- 按钮/
|   |   |-- 查询;
|   |   |-- 查看全部;
|   |
|   |-- 表格/
|   |   |-- 表00;
|   |
|   |-- 文本框/
|       |-- 商品名称;
|
|-- 出库部分/
|   |-- 按钮/
|   |   |-- 出库;
|   |   |-- 查询;
|   |   |-- 导出今日送货信息为表格;
|   |
|   |-- 表格/
|   |   |-- 表00;
|   |
|   |-- 文本框/
|       |-- 代销处ID
|       |-- 代销处名称;
|       |-- 商品ID;
|       |-- 商品名称;
|       |-- 商品出库数量;
|       |-- 商品售价单价;
|       |-- 商品售价总价;
|       |-- 客户ID;
|       |-- 客户名称;
|
|-- 客户部分/
|   |-- 按钮/
|   |   |-- 查询;
|   |   |-- 代销处查询;
|   |   |-- 补全/更改信息;
|   |   |-- 查看全部;
|   |   |-- 导出全部为表格;
|   |
|   |-- 表格/
|   |   |-- 表00;
|   |
|   |-- 文本框/
|           |-- 客户ID;
|           |-- 客户名称;
|           |-- 联系电话;
|           |-- 代销处ID;
|           |-- 代销处名称;
|
|-- 代销处部分/
|   |-- 按钮/
|   |   |-- 增;
|   |   |-- 删;
|   |   |-- 查;
|   |   |-- 查看全部;
|   |
|   |-- 表格/
|   |   |-- 表00;
|   |
|   |-- 文本框/
|       |-- ID;
|       |-- 名称;
|       |-- 电话;
|
|-- 利润部分/
|   |-- 按钮/
|   |   |-- 查询;
|   |   |-- 查看全部;
|   |   |-- 导出全部为表格;
|   |
|   |-- 表格/
|   |   |-- 表00;
|   |
|   |-- 文本框/
|       |-- 总利润;
|       |-- 总支出;
|       |-- 总收入;
|
|-- 特殊隐藏部分/
    |-- 按钮/
        |-- 删库跑路按钮;
```
## 功能及功能异常解释
- 0. 日期部分: 按照YYYY/MM/DD格式输入日期, 或者统一1个标准;
- 1. 进库部分
    - 0. 按钮
        - 0. 进库
            - 0. 将输入的进库商品信息存入数据库中并将该日进库的所有商品显示在"this.表00"中;
            - 1. 将在"商户ID", "商户名称", "代销处ID", "代销处名称"内输入的商户信息存入数据库;
            - 2. 将在"商品进价总价"内输入的利润信息存入数据库;
            - 3. 更新"库存"和"利润"部分的输出: "库存.表00","利润.表00", "利润.总利润", "利润.总支出", "利润.总收入";
        - 1. 查询: 通过输入的日期信息在"this.表00"中显示所有该日期内的进库商品;
    - 1. 按钮(异常)
        - 0. "进库"按钮失效
            - 0. 请确保"代销处ID"存在于数据库中, 若不存在则在代销处部分添加该代销处;
            - 1. 请确保"日期"处填写正确;
    - 2. 表格
        - 0. 表00: 输出某1天的进库商品信息;
- 2. 商户部分
    - 0. 按钮
        - 0. 查询: 通过在"商户名称"中输入的字符串在数据库中查询所有匹配的商户并显示在"this.表00"中;
        - 1. 代销处查询: 通过在"代销处名称"中输入的字符串在数据库中查询所有匹配的商户并显示在"this.表00"中;
        - 2. 补全/更改信息: 将输入的商户信息与数据库中的信息匹配并更新, 并显示在"this.表00"中, 常常用来补全在进库时创建的不完全的商户信息;
        - 3. 查看全部: 将所有商户的信息显示在"this.表00"中;
        - 4. 导出全部为表格: 将所有输入的商户信息导出为1个表格, 路径为"database controler/database controler/data/from-shop-infor.csv";
    - 1. 按钮(异常)
        - 0. "补全/更改信息"按钮失效: 确保"代销处ID"存在于数据库中, 若不存在则在代销处部分添加该代销处;
    - 2. 表格
        - 0. 表00: 输出商户信息;
- 3. 库存部分
    - 0. 按钮
        - 0. 查询: 通过在"商品名称"中输入的字符串在数据库中查询所有匹配的库存商品的信息并显示在"this.表00"中;
        - 1. 查看全部: 将所有库存商品信息显示在"this.表00"中;
    - 1. 表格
        - 0. 表00: 输出库存商品信息;
- 4. 出库部分
    - 0. 按钮
        - 0. 出库
            - 0. 将输入的出库商品信息存入数据库中并将该日出库的所有商品显示在"this.表00"中;
            - 1. 将在"客户ID", "客户名称", "代销处ID", "代销处名称"内输入的客户信息存入数据库;
            - 2. 将在"商品售价总价"内输入的利润信息存入数据库;
            - 3. 更新"库存"和"利润"部分的输出: "库存.表00","利润.表00", "利润.总利润", "利润.总支出", "利润.总收入";
        - 1. 查询: 通过输入的日期信息在"this.表00"中显示所有该日期内的出库商品;
        - 2. 导出今日送货信息为表格: 通过输入的日期信息将所有与日期匹配的出库商品信息中的1部分导出至表格, 路径为"database controler/database controler/data/output-item-log/[日期].csv";
    - 1. 按钮(异常)
        - 0. 出库按钮失效
            - 0. 检查库存商品是否足够;
            - 1. 检查代销处ID是否存在于数据库中;
            - 2. 检查日期信息是否正确;
        - 1. 导出今日送货信息为表格
            - 0. 检查日期信息是否正确;
            - 1. 检查当日是否确实有商品的出库(可通过"this.查询"按钮);
    - 2. 表格
        - 0. 表00: 输出某1天内的出库商品信息;
- 5. 客户部分
    - 0. 按钮
        - 0. 查询: 通过在"客户名称"中输入的字符串在数据库中查询所有匹配的客户并显示在"this.表00"中;
        - 1. 代销处查询: 通过在"代销处名称"中输入的字符串在数据库中查询所有匹配的客户并显示在"this.表00"中;
        - 2. 补全/更改信息: 将输入的客户信息与数据库中的信息匹配并更新, 并显示在"this.表00"中, 常常用来补全在出库时创建的不完全的客户信息;
        - 3. 查看全部: 将所有商户的信息显示"this.表00"中;
        - 4. 导出全部为表格: 将所有输入的客户信息导出为1个表格, 路径为"database controler/database controler/data/to-shop-infor.csv";
    - 1. 按钮(异常)
        - 0. "补全/更改信息"按钮失效: 确保"代销处ID"存在于数据库中, 若不存在则在代销处部分添加该代销处;
    - 2. 表格
        - 0. 表00: 输出客户信息;
- 6. 代销处部分
    - 0. 按钮
        - 0. 增: 将输入的代销处信息存入数据库中;
        - 1. 删: 通过"代销处ID"内输入的字符串与数据库中的信息匹配并删除;
        - 2. 查: 通过"代销处名称"内输入的字符串子啊数据库中查询所有匹配的代销处并显示在"this.表00"中;
        - 3. 查看全部: 将所有代销处的信息显示在"this.表00"中;
    - 1. 表格
        - 0. 表00: 输出客户信息;
- 7. 利润部分
    - 0. 按钮
        - 0. 查询: 通过输入的日期信息在"this.表00"中显示所有该日的进库商品;
        - 1. 查看所有: 在"this.表00"中显示所有日期的利润信息;
        - 2. 导出全部为表格: 将所有的利润信息导出为1个表格, 路径为"database controler/database controler/data/profit.csv";
    - 1. 表格
        - 0. 表00: 输出某1天的利润信息;
    - 2. 文本框
        - 0. 总利润: 输出所有时间的总利润, 可以是负数表示非亏损;
        - 1. 总支出: 输出所有时间的总支出;
        - 2. 总收入: 输出所有时间的总收入;
- 8. 特殊隐藏部分
    - 0. 按钮
        - 0. 删库跑路按钮: 清空所有数据库中的表中的数据;
## 操作步骤
### 主要步骤
- 0. 添加代销处
    - 0. 在"代销处.文本框"中按照文字提示输入代销处的信息;
    - 1. 点击"代销处.增加";
- 1. 添加进库商品("代销处订购所需商品")
    - 0. 在"日期.文本框"中输入进库商品的日期;
    - 1. 在"进库.文本框"中按照文字提示输入进库商品的信息(商品进价总价可以随意填写)
        - 0. 代销处ID必须在数据库中;
    - 2. 点击"进库.进库";
    - 3. 观察"进库.表00"的显示"("查看代销处的订购情况");
- 2. 补完商户信息
    - 0. 在"商户.ID"中输入想要补完的商户ID;
    - 1. 在"商户.文本框"中输入想要补完的商户的其余信息;
    - 2. 点击"商户.补全/更改信息";
    - 3. 观察"商户.表00"的显示;
- 3. 添加出库商品
    - 0. 在"日期.文本框"中输入出库商品的日期;
    - 1. 在"出库.文本框"中按照文字提示输入出库商品的信息(商品售价总价可以随意填写)
        - 0. 代销处ID必须在数据库中;
        - 1. 出库商品的数量必须小于等于库存商品的数量;
    - 2. 点击"出库.出库";
    - 3. 观察"出库.表00"的显示;
- 4. 补完客户信息
    - 0. 在"客户.ID"中输入想要补完的客户ID;
    - 1. 在"客户.文本框"中输入想要补完的客户的其余信息;
    - 2. 点击"客户.补全/更改信息";
    - 3. 观察"客户.表00"的显示;
- 5. 导出今日送货信息("公司送货主管生成每天的送货清单")
    - 0. 在"日期.文本框"中输入今日日期;
    - 1. 点击"出库.导出今日送货信息为表格"按钮;
    - 2. 在路径"database controler/database controler/data/output-item-log/[日期].csv"中观察结果;
### 可选步骤
- 0. 通过日期查询日期内代销处的进库商品("销售处或公司主管查看代销处的订购情况")("通过输入下单年月查询对应月份代销处的订货情况")
    - 0. 在"日期.文本框"中输入想要查询的进库商品的进库日期;
    - 1. 点击"进库.查询";
    - 2. 观察"进库.表00"的显示;
- 1. 通过商户名称查询商户信息("通过输入用户代号?查询用户信息?")
    - 0. 在"商户.商户名称"中输入想要查询的商户的商户名称;
    - 1. 点击"商户.查询";
    - 2. 观察"商户.表00"的显示;
- 2. 通过日期查询日期内代销处的出库商品("公司送货主管生成每天的送货清单")
    - 0. 在"日期.文本框"中输入想要查询的进库商品的进库日期;
    - 1. 点击"出库.查询";
    - 2. 观察"出库.表00"的显示;
- 3. 通过日期查询日期内公司的利润("公司财务主管统计相关销售金额")
    - 0. 在"日期.文本框"中输入想要查询的利润的日期;
    - 1. 点击"查询";
    - 2. 观察"利润.表00"的显示;
- 4. 查询公司内所有日期的利润("公司财务主管统计相关销售金额")
    - 0. 观察"利润.文本框"的显示;
    - 1. 点击"利润.查看全部";
    - 2. 观察"利润.表00"的显示;
- 5. 导出公司内所有日期的利润为表格("公司财务主管统计相关销售金额")
    - 0. 点击"利润.导出全部为表格"按钮;
    - 1. 在路径"database controler/database controler/data/profit.csv"中观察结果;
- 6. 查询所有商户和所有客户("公司营销主管每月底造1张用户表, 表中包括用户代号, 代销处名, 负责人姓名, 联系电话, 代销处地址")
    - 0. 点击"商户.查看全部"按钮;
    - 1. 观察"商户.表00"的显示;
    - 2. 点击"客户.查看全部";
    - 3. 观察"客户.表00"的显示;
- 7. 导出所有商户和所有客户的信息为表格("公司营销主管每月底造1张用户表, 表中包括用户代号, 代销处名, 负责人姓名, 联系电话, 代销处地址")
    - 0. 点击"商户.导出全部为表格";
    - 1. 点击"客户.导出全部为表格";
    - 2. 在路径"database controler/database control/data/from-shop-infor.csv"中观察结果;
    - 3. 在路径"database controler/database control/data/to-shop-infor.csv"中观察结果;
- 8. 通过代销处的ID删除代销处;
    - 0. 在"代销处.ID"中输入想要删除的代销处的ID;
    - 1. 点击"代销处.删"按钮;
- 9. 通过代销处的名称查询代销处信息;
    - 0. 在"代销处.名称"中输入想要查询的代销处的名称;
    - 1. 点击"代销处.查";
    - 2. 观察"代销处.表00"的显示;
- 10. 查看全部代销处的信息
    - 0. 点击"代销处.查看全部";
    - 1. 观察"代销处.表00"的显示;
- 11. 通过代销处的名称查询商户信息;
    - 0. 在"商户.代销处名称"中输入想要查询的代销处的名称;
    - 1. 点击"商户.代销处查询";
    - 2. 观察"商户.表00"的显示;
- 12. 查询库存;
    - 0. 在"库存.商品名称"中输入想要查询的商品的名称;
    - 1. 点击"库存.查询"
    - 2. 观察"库存.表00"的显示;
- 13. 查看全部库存;
    - 0. 点击"库存.查看全部";
    - 1. 观察"库存.表00"的显示;
- 15. 通过客户的名称查询客户信息;
    - 0. 在"客户.ID"中输入想要查询的客户的ID;
    - 1. 点击"客户.查询";
    - 2. 观察"客户.表00"的显示;
- 16. 通过代销处的名称查询客户信息;
    - 0. 在"客户.代销处名称"中输入想要查询的代销处的名称;
    - 1. 点击"客户.代销处查询";
    - 2. 观察"客户.表00"的显示;
## 测试用例(电话换乘联系方式了)
- 0. 代销处列表

    |ID|名称|联系方式|
    |:-:|:-:|:-:|
    |00|DMM|www.dmm.com|
    |01|GooglePlay|8.8.8.8|
    |02|pilipili|ChenRui(陈睿)|

- 1. 进库商品

    |日期|代销处ID|代销处名称|商品ID|商品名称|商品进库数量|商品进价单价|商户ID|商户名称|
    |:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
    |2020/05/01|02|pilipili|00|1Dan|648|10000|03|TypeMoon|
    |2020/05/01|01|GooglePlay|01|GirlPaPass|2000|480|01|BuShiRoad|
    |2020/05/01|00|DMM|02|BedPosition|3500|1000|00|C2KiKaN|
    |2020/06/01|01|GooglePlay|03|1Dan|648|10000|02|Cygames|
    |2020/06/01|01|GooglePlay|04|1Dan|648|10000|01|BuShiRoad|
    |2020/06/01|01|GooglePlay|01|GirlPaPass|2000|480|01|BuShiRoad|

- 2. 商户信息

    |ID|名称|联系人|
    |:-:|:-:|:-:|
    |00|C2KiKaN(C2機関)|TaNaKa SaN(田中　謙介)|
    |01|BuShiRoad(ブシロード)|KiTaNi SaN(木谷　高明)|
    |02|Cygames|WaTaNaBe(渡辺　耕一)|
    |03|TypeMoon|NaSu SaN(奈須　きのこ(武内　崇写不下了))|

- 3. 出库商品

    |日期|代销处ID|代销处名称|商品ID|商品名称|商品出库数量|商品售价单价|客户ID|客户名称|
    |:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
    |2021/01/01|01|GooglePlay|01|GirlPaPass|1|480|02|lening_koei|
    |2021/01/01|02|pilipili|00|1Dan|10|10000|00|Lening|
    |2021/01/01|00|DMM|02|BedPosition|1|1000|00|Lening|
    |2021/01/01|01|GooglePlay|01|GirlPaPass|1|480|01|LeningKoei|
    |2021/01/02|02|pilipili|00|1Dan|10|10000|02|lening_koei|
    |2021/01/02|00|DMM|02|BedPosition|1|1000|01|LeningKoei|
    |2021/01/02|00|DMM|02|BedPosition|1|1000|02|lening_koei|
    |2021/01/02|00|DMM|02|BedPosition|1|1000|02|lening_koei|

- 4. 客户信息("01.联系方式"和"02.联系方式"需要拼合才能访问哦)

    |ID|名称|联系方式|
    |:-:|:-:|:-:|
    |00|Lening|18920010815|
    |01|LeningKoei|www.lening|
    |02|lening_koei|koei.com|

- 5. * 商品信息

    |ID|名称|单价|商户ID|商户名称|代销处ID|代销处名称|
    |:-:|:-:|:-:|:-:|:-:|:-:|:-:|
    |00|1Dan(1单)|10000|03|TypeMoon|02|pilipili|
    |01|GirlPaPass(ガルパPass)|480|01|BuShiRoad|01|GooglePlay|
    |02|BedPosition(床位)|1000|00|C2KiKaN|00|DMM|
    |03|1Dan(1单)|10000|02|Cygames|01|GooglePlay|
    |04|1Dan(1单)|10000|01|BuShiRoad|01|GooglePlay|

- 测试中出现的商户名称, 代销处名称和及其联系方式, 商品名称等均与现实中的各个团体无关;
## 测试操作步骤
- 0. 添加代销处信息;
- 1. 删除代销处信息;
- 2. 增加代销处信息;
- 3. 查询代销处信息;
- 4. 添加进库商品信息;
- 5. 查询进库商品信息;
- 6. 查看全部商户信息;
- 7. 补全商户信息;
- 8. 查询商户信息;
- 9. 通过代销处名称查询商户信息;
- 10. 查看全部商户信息;
- 11. 导出全部商户信息为表格;
- 12. 查询库存;
- 13. 查看全部库存;
- 14. 添加商品出库信息;
- 15. 查询出库商品信息;
- 16. 导出今日送货信息为表格;
- 17. 补全客户信息;
- 18. 查询客户信息;
- 19. 通过代销处查询客户信息;
- 20. 查看全部客户信息;
- 21. 导出全部客户信息为表格;
- 22. 查看所有日期利润;
- 23. 查看指定日期利润;
- 24. 将所有利润信息导出为表格;
## 存在的主要问题
- 0. *严重问题*但是并非是实现上的问题, 而是设计上的问题, 即1个商户ID只能对应1个代销处ID, 1个客户ID只能对应1个代销处ID(但是1个代销处ID可以对应多个商户ID和客户ID, 而且整体上允许了重名(指名称重复)不重复ID的存在);
- 1. 每次成对出现的2列实际上没什么关联, 比如ID正确, 名称错误也是不影响结果的, 但是可能会出现结果与用户的预期不符的情况, 其实可以在里面多加1步值的查询和验证来解决这个问题;
- 2. 中文输入会显示??(不过内部是没错的, 只是编码无法显示), 可以通过重建表来把varchar换成nvarchar, 每次输入+N来解决这个问题;
- 3. 日期先后问题没管(可以通过把日期输入文本框改成[文本框]年[文本框]月[文本框]日来分别读取并判断, 不过这个时候了就不管了把);
- 4. 库存中同名商品中用户无法区别商品(当测试用例中有多个同名商品的时候才发现缺少了这么1个反向的查找, 可以通过在库存中添加"商户名称"列来解决这个问题)
- 5. 生成表格数据的"data"文件夹实在是太难找了, 我本来是想要使用"../"来退回到上级目录, 但是并不能成功, 原因是当前文件夹已经是根目录了, 不过我能找到并且能使用的使用相对路径的方法就这了;
- 6. 生成的.csv文件内部是没问题的, 但是excel显示"00"之类的数据时会自动把"多余的"那个"0"给省略了, 这波是excel你在教我做事?;
## 优化方案
- 0. 尽可能解决"存在的主要问题";
- 1. 输入信息的时候可以使用下拉框关联数据库来优化信息输入的体验;
- 2. 点击按钮来操作的时候我是直接省去了弹窗提示信息, 可以加入来优化互动体验;
- 3. 增加1个清空本部分的文本框中字符串的按钮;
## 后记
说明书完全抛弃了 https://github.com/RichardLitt/standard-readme/blob/master/spec.zh-CN.md 中提到的什么README的规范, 力求事无巨细的具体解决用户在使用中遇到的各种问题, 可能确实不太适合阅读, 查询条目也很困难, 但是在详细与完整性上已经竭尽我个人的全力了, 本身这个程序的交互型就极差, 仅仅能实现功能而已;
